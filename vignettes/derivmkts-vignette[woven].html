<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>derivmkts-vignette[woven].html</title>

</head>

<body>

<hr />

<p>title: "Option Pricing Functions to Accompany <em>Derivatives Markets</em>"
author: "Robert McDonald"
date: '2015-10-21'
output:
  html<em>document:
    toc: yes
    fig</em>caption: yes
  pdf<em>document:
    fig</em>caption: yes</p>

<h2>    toc: yes</h2>

<h1>Introduction</h1>

<p>This provides some additional documentation and examples for the R
package <code>derivmkts</code>, which is meant as a companion to <em>Derivatives
Markets</em>. There are of course other option pricing packages for R, but
this package uses function names corresponding to the usage in the
book.</p>

<h1>Basic Pricing Functions</h1>

<h2>Black-Scholes</h2>

<p>The functions <code>bscall</code>, <code>bsput</code>, and <code>bsopt</code> provide basic pricing of
European calls and puts. There are also options with binary payoffs:
cash-or-nothing and asset-or-nothing options. All functions are
vectorized. The function <code>bsopt</code> provides option greeks. Here are some
examples:</p>

<p>```r
s &lt;- 100; k &lt;- 100; r &lt;- 0.08; v &lt;- 0.30; tt &lt;- 2; d &lt;- 0
bscall(s, k, v, r, tt, d)</p>

<h2>[1] 24.02467</h2>

<p>bsput(s, k, v, r, tt, d)</p>

<h2>[1] 9.239054</h2>

<p>bsput(s, c(95, 100, 105), v, r, tt, d)</p>

<h2>[1]  7.487590  9.239054 11.187942</h2>

<p>bsopt(s, c(95, 100, 105), v, r, tt, d)$Call</p>

<h2>bscall<em>95   bscall</em>100   bscall_105</h2>

<h2>Price      26.533930250 24.024674750 21.712843936</h2>

<h2>Delta       0.761196021  0.722155105  0.682341365</h2>

<h2>Gamma       0.007307399  0.007904504  0.008402985</h2>

<h2>Vega        0.438443163  0.474271156  0.504178762</h2>

<h2>Rho         0.991713418  0.963816696  0.930425833</h2>

<h2>Theta      -0.019877199 -0.020307673 -0.020556285</h2>

<h2>Psi        -1.522392056 -1.444310226 -1.364682749</h2>

<h2>Elasticity  2.868764688  3.005889205  3.142570208</h2>

<p>```</p>

<h2>Barrier Options</h2>

<p>There are pricing functions for a large number of barrier options: </p>

<ul>
<li>down-and-in and down-and-out barrier binary options</li>
<li>up-and-in and up-and-out barrier binary options</li>
<li>more standard down- and up- calls and puts, constructed using the barrier binary options</li>
</ul>

<p>Naming for the barrier options generally follows the convention</p>

<p><code>[u|d][i|o][call|put]</code></p>

<p>which means that the option is "up" or "down", "in" or "out", and a
call or put.^[The naming convention here differs from that in
<em>Derivatives Markets</em>, in which names are <code>callupin</code>, <code>callupout</code>,
etc. For consistency, but possibly at the cost of confusion, I have
made both names are available for these functions.]  An up-and-in
call, for example, would be denoted by <code>uicall</code>. For binary options,
we add the underlying, which is either the asset or \$1:
cash:</p>

<p><code>[asset|cash][u|d][i|o][call|put]</code></p>

<p>```r
H &lt;- 105
uicall(c(95, 100, 105), k, v, r, tt, d, H)</p>

<h2>[1] 20.51497 24.02383 27.73038</h2>

<p>bscall(c(95, 100, 105), k, v, r, tt, d)</p>

<h2>[1] 20.51669 24.02467 27.73038</h2>

<p>```</p>

<h2>Option Greeks</h2>

<p>Greeks can be computed one of two ways. The <code>greeks</code> function takes as arguments the name of the pricing function and then its inputs. The <code>greeks2</code> function takes the function call as an input. Here are illustrations of the two functions using the same parameters:</p>

<p>```r
greeks(uicall(s, k, v, r, tt, d, H))</p>

<h2>uicall</h2>

<h2>Price      24.023834247</h2>

<h2>Delta       0.722328367</h2>

<h2>Gamma       0.007903118</h2>

<h2>Vega        0.474353223</h2>

<h2>Rho         0.963837754</h2>

<h2>Theta      -0.020309590</h2>

<h2>Psi        -1.444314473</h2>

<h2>Elasticity  3.006715579</h2>

<p>greeks2(uicall, s=s, k=k, v=v, r=r, tt=tt, d=d, H=H)</p>

<h2>uicall</h2>

<h2>Price      24.023834247</h2>

<h2>Delta       0.722328367</h2>

<h2>Gamma       0.007903118</h2>

<h2>Vega        0.474353223</h2>

<h2>Rho         0.963837754</h2>

<h2>Theta      -0.020309590</h2>

<h2>Psi        -1.444314473</h2>

<h2>Elasticity  3.006715579</h2>

<p>```</p>

<h2>Binomial Pricing</h2>

<p>There are two functions in this section: <code>binomopt</code>, which computes
binomial option prices, and <code>binomplot</code>, which displays the asset
price tree, the corresponding probability of being at each node, and
whehter or not the option is in exercised at each node.</p>

<h3><code>binomopt</code></h3>

<p>Here are examples of pricing, illustrating the default of just
returning the price, and the ability to return the price plus
parameters, as well as the price, the parameters, and various trees:</p>

<p>```r
s &lt;- 100; k &lt;- 100; r &lt;- 0.08; v &lt;- 0.30; tt &lt;- 2; d &lt;- 0.03
binomopt(s, k, v, r, tt, d, nstep=4)</p>

<h2>[1] 20.28837</h2>

<p>binomopt(s, k, v, r, tt, d, nstep=4, returnparams=TRUE)</p>

<h2>$price</h2>

<h2>[1] 20.28837</h2>

<h2> </h2>

<h2>$params</h2>

<h2>s           k           v           r          tt           d</h2>

<h2>100.0000000 100.0000000   0.3000000   0.0800000   2.0000000   0.0300000</h2>

<h2>nstep           p          up          dn           h</h2>

<h2>4.0000000   0.4471650   1.2676085   0.8293342   0.5000000</h2>

<p>binomopt(s, k, v, r, tt, d, nstep=4, putopt=TRUE)</p>

<h2>[1] 12.37422</h2>

<p>binomopt(s, k, v, r, tt, d, nstep=4, returntrees=TRUE, putopt=TRUE)</p>

<h2>$price</h2>

<h2>[1] 12.37422</h2>

<h2> </h2>

<h2>$params</h2>

<h2>s           k           v           r          tt           d</h2>

<h2>100.0000000 100.0000000   0.3000000   0.0800000   2.0000000   0.0300000</h2>

<h2>nstep           p          up          dn           h</h2>

<h2>4.0000000   0.4471650   1.2676085   0.8293342   0.5000000</h2>

<h2> </h2>

<h2>$oppricetree</h2>

<h2>[,1]      [,2]      [,3]     [,4]     [,5]</h2>

<h2>[1,] 12.37422  4.150096  0.000000  0.00000  0.00000</h2>

<h2>[2,]  0.00000 19.939844  7.813297  0.00000  0.00000</h2>

<h2>[3,]  0.00000  0.000000 31.220474 14.70993  0.00000</h2>

<h2>[4,]  0.00000  0.000000  0.000000 42.95878 27.69407</h2>

<h2>[5,]  0.00000  0.000000  0.000000  0.00000 52.69377</h2>

<h2> </h2>

<h2>$stree</h2>

<h2>[,1]      [,2]      [,3]      [,4]      [,5]</h2>

<h2>[1,]  100 126.76085 160.68312 203.68329 258.19066</h2>

<h2>[2,]    0  82.93342 105.12711 133.26002 168.92152</h2>

<h2>[3,]    0   0.00000  68.77953  87.18551 110.51709</h2>

<h2>[4,]    0   0.00000   0.00000  57.04122  72.30593</h2>

<h2>[5,]    0   0.00000   0.00000   0.00000  47.30623</h2>

<h2> </h2>

<h2>$probtree</h2>

<h2>[,1]     [,2]      [,3]       [,4]       [,5]</h2>

<h2>[1,]    1 0.447165 0.1999565 0.08941355 0.03998261</h2>

<h2>[2,]    0 0.552835 0.4944169 0.33162889 0.19772377</h2>

<h2>[3,]    0 0.000000 0.3056266 0.40999649 0.36667214</h2>

<h2>[4,]    0 0.000000 0.0000000 0.16896107 0.30221389</h2>

<h2>[5,]    0 0.000000 0.0000000 0.00000000 0.09340760</h2>

<h2> </h2>

<h2>$exertree</h2>

<h2>[,1]  [,2]  [,3]  [,4]  [,5]</h2>

<h2>[1,] FALSE FALSE FALSE FALSE FALSE</h2>

<h2>[2,] FALSE FALSE FALSE FALSE FALSE</h2>

<h2>[3,] FALSE FALSE  TRUE FALSE FALSE</h2>

<h2>[4,] FALSE FALSE FALSE  TRUE  TRUE</h2>

<h2>[5,] FALSE FALSE FALSE FALSE  TRUE</h2>

<p>```</p>

<h1>Illustrative Functions</h1>

<p>Several functions are intended to illustrate some aspects of the
material. </p>

<h2>Quincunx or Galton Board</h2>

<h2>Plotting the Solution to the Binomial Pricing Model</h2>

<p>The <code>binomplot</code> function calls <code>binomopt</code> to compute the option price
and the various trees, which it then uses in plotting:</p>

<p>The first plot, figure \ref{fig:binomplot1}, is basic:</p>

<p><code>r
binomplot(s, k, v, r, tt, d, nstep=6, american=TRUE, putopt=TRUE)
</code></p>

<p><img src="figure/binomplot1-1.png" alt="Basic option plot showing stock prices and nodes at which the option is exercised.\label{fig:binomplot1}" title="" /> </p>

<p>The second plot, figure \ref{fig:binomplot2}, adds a display of stock
prices and arrows connecting the nodes.</p>

<p><code>r
binomplot(s, k, v, r, tt, d, nstep=6, american=TRUE, putopt=TRUE,
    plotvalues=TRUE, plotarrows=TRUE)
</code></p>

<p><img src="figure/binomplot2-1.png" alt="Same plot as Figure \ref{fig:binomplot1} except that values and arrows are added to the plot.\label{fig:binomplot2}" title="" /> </p>

<p>Finally, here is a plot for an American call when the dividend yield
is positive and <code>nstep</code> has a larger value:</p>

<p><code>r
d &lt;- 0.06
binomplot(s, k, v, r, tt, d, nstep=50, american=TRUE)
</code></p>

<p><img src="figure/unnamed-chunk-6-1.png" alt="Binomial plot when nstep=50.\label{fig:binomplot3}" title="" /> </p>

<p>Notice that the large value of <code>nstep</code> creates a high maximum terminal
stock price, which makes the plot hard to see in the narrow region where
exercise is occurring. We can zoom in on that region by setting
<code>ylimval=TRUE</code> and selecting values for <code>ylimval</code>:</p>

<p><code>r
d &lt;- 0.06
binomplot(s, k, v, r, tt, d, nstep=50, american=TRUE, setylim=TRUE, ylimval=c(75, 225))
</code></p>

<p><img src="figure/unnamed-chunk-7-1.png" alt="Binomial plot when nstep=50, using the argument ylimval to focus on a subset..\label{fig:binomplot4}" title="" /> </p>

</body>
</html>
